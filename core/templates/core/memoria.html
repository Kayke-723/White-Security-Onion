{% extends "core/base.html" %}
{% block content %}
<h2>Gerenciamento de Memória</h2>
<p>Total: {{ total }} — Usado: {{ used }} — Livre: {{ free }}</p>

{% csrf_token %}
<input type="hidden" name="action" value="allocate">
<div class="row">
    <div class="col">
        <input class="form-control" type="text" name="pname" placeholder="Nome do processo" required>
    </div>
    <div class="col">
        <input class="form-control" type="number" name="psize" placeholder="Tamanho (unidades)" min="1" required>
    </div>
    <div class="col">
        <button class="btn btn-primary" type="submit">Alocar</button>
    </div>
</div>
</form>

<h4>Blocos alocados</h4>
<table class="table">
    <thead>
        <tr>
            <th>ID</th>
            <th>Processo</th>
            <th>Tamanho</th>
            <th>Ação</th>
        </tr>
    </thead>
    <tbody>
        {% for b in blocks %}
        <tr>
            <td>{{ b.id }}</td>
            <td>{{ b.process.name }}</td>
            <td>{{ b.size }}</td>
            <td>
                <form method="post" style="display:inline">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="free">
                    <input type="hidden" name="block_id" value="{{ b.id }}">
                    <button class="btn btn-danger btn-sm" type="submit">Liberar</button>
                </form>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="4">Nenhum bloco alocado</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}